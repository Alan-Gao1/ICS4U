<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
</head>
<body>
    <nav class="navbar">
        <div class="navbar-brand">
            <a href="chess.html" class="navbar-item">
                <img src="https://images.chesscomfiles.com/uploads/v1/images_users/tiny_mce/SamCopeland/phpmeXx6V.png" alt="" class="mr-2">
                Global Chess Rankings
            </a>
        </div>
        <a href="admin.html" class="navbar-item">Admin</a>
        <a href="games.html" class="navbar-item">Games</a>
    </nav>
    <div class="columns mt-1 m-0">
        <div class="field box column">
            <strong class="is-size-5">Add a Game</strong>
            <input type="date" class="input is-rounded mb-2 mt-2" id="date">
            <input type="text" class="input is-rounded mb-2" id="whitePlayer" placeholder="White Player Name">
            <input type="text" class="input is-rounded mb-2" id="blackPlayer" placeholder="Black Player Name">
            <strong>Who Won?</strong>
            <div class="control mb-3">
                <label class="radio">
                    <input type="radio" name="answer" class="mr-1" id="whiteWin">White
                </label>
                <label class="radio">
                    <input type="radio" name="answer" class="mr-1" id="blackWin">Black
                </label>
                <label class="radio">
                    <input type="radio" name="answer" class="mr-1" id="stalemate">Stalemate
                </label>
            </div>
            <strong>Type of Game?</strong>
            <br>
            <div class="select mb-1 mt-2">
                <select id="type">
                    <option value="classicalType">Classical Game</option>
                    <option value="rapidType">Rapid Game</option>
                    <option value="blitzType">Blitz Game</option>
                </select>
            </div>
            <br>
            <label class="is-centered"><strong>Enter the Number of moves of each type:</strong></label>
            <div class="columns">
                <div class="column">
                    <label>White:</label>
                    <input type="text" class="input is-rounded mb-2 mt-2 is-small" id="brilliantW" placeholder="Brilliant Moves">
                    <input type="text" class="input is-rounded mb-2 is-small" id="greatW" placeholder="Great Moves">
                    <input type="text" class="input is-rounded mb-2 is-small" id="bestW" placeholder="Best Moves">
                    <input type="text" class="input is-rounded mb-2 is-small" id="excellentW" placeholder="Excellent Moves">
                    <input type="text" class="input is-rounded mb-2 is-small" id="goodW" placeholder="Good Moves">
                    <input type="text" class="input is-rounded mb-2 is-small" id="bookW" placeholder="Book Moves">
                    <input type="text" class="input is-rounded mb-2 is-small" id="inaccuracyW" placeholder="Innacuracies">
                    <input type="text" class="input is-rounded mb-2 is-small" id="mistakeW" placeholder="Mistakes">
                    <input type="text" class="input is-rounded mb-2 is-small" id="blunderW" placeholder="Blunders">
                    <input type="text" class="input is-rounded mb-2 is-small" id="missedW" placeholder="Missed Wins">
                </div>
                <div class="column">
                    <label>Black</label>
                    <input type="text" class="input is-rounded mb-2 mt-2 is-small" id="brilliantB" placeholder="Brilliant Moves">
                    <input type="text" class="input is-rounded mb-2 is-small" id="greatB" placeholder="Great Moves">
                    <input type="text" class="input is-rounded mb-2 is-small" id="bestB" placeholder="Best Moves">
                    <input type="text" class="input is-rounded mb-2 is-small" id="excellentB" placeholder="Excellent Moves">
                    <input type="text" class="input is-rounded mb-2 is-small" id="goodB" placeholder="Good Moves">
                    <input type="text" class="input is-rounded mb-2 is-small" id="bookB" placeholder="Book Moves">
                    <input type="text" class="input is-rounded mb-2 is-small" id="inaccuracyB" placeholder="Innacuracies">
                    <input type="text" class="input is-rounded mb-2 is-small" id="mistakeB" placeholder="Mistakes">
                    <input type="text" class="input is-rounded mb-2 is-small" id="blunderB" placeholder="Blunders">
                    <input type="text" class="input is-rounded mb-2 is-small" id="missedB" placeholder="Missed Wins">
                </div>
            </div>
            <div class="control" onclick="addGame()">
                <button class="button is-primary">Submit</button>
            </div>
        </div>
        <div class="field box column">
            <strong class="is-size-5">Add a Player</strong>
            <input type="text" class="input is-rounded mb-2 mt-2" id="pFirstName" placeholder="First Name">
            <input type="text" class="input is-rounded mb-2" id="pLastName" placeholder="Last Name">
            <input type="text" class="input is-rounded mb-2" id="classical" placeholder="Classical Rating">
            <input type="text" class="input is-rounded mb-2" id="rapid" placeholder="Rapid Rating">
            <input type="text" class="input is-rounded mb-2" id="blitz" placeholder="Blitx Rating">
            <div class="control" onclick="addPlayer()">
                <button class="button is-primary mt-1">Submit</button>
            </div>
        </div>
    </div>
</body>

<script>
    let tempData = JSON.parse(localStorage.getItem("data"));
    let tempSeen = JSON.parse(localStorage.getItem("seen"))

    function addPlayer(){
        let firstName = document.querySelector('#pFirstName').value;
        let lastName = document.querySelector('#pLastName').value;
        let name = firstName.concat(" ", lastName);
        let classical = document.querySelector('#classical').value;
        let rapid = document.querySelector('#rapid').value;
        let blitz = document.querySelector('#blitz').value;
        let id = tempData[tempData.length -1].id;
        parseInt(id)
        id++;
        let finID = id.toString();
        tempData.push({
            name: name,
            id: finID,
            classicalRating: classical,
            rapidRating: rapid,
            blitzRating: blitz,
            games: []
        });
        let playersString = JSON.stringify(tempData);
        localStorage.setItem("data", playersString);
    }

    function addGame(){
        let date = document.getElementById('date')
        let dateValue = date.value;
        let whitePlayer = document.getElementById('whitePlayer').value
        let blackPlayer = document.getElementById('blackPlayer').value
        let winner = ""
        if(document.getElementById('whiteWin').checked){
            winner = "1"
        }else if(document.getElementById('blackWin').checked){
            winner = "0"
        }else if(document.getElementById('stalemate').checked){
            winner = "-1"
        }

        let type = document.getElementById('type')
        let selectedValue = type.options[type.selectedIndex].value
        let gameType = "";
        if(selectedValue === "classicalType"){
            gameType = "classical"
        }else if(selectedValue === "rapidType"){
            gameType = "rapid"
        }else if(selectedValue === "blitzType"){
            gameType = "blitz"
        }

        let brilliantW = document.getElementById('brilliantW').value
        let greatW = document.getElementById('greatW').value
        let bestW = document.getElementById('bestW').value
        let excellentW = document.getElementById('excellentW').value
        let goodW = document.getElementById('goodW').value
        let bookW = document.getElementById('bookW').value
        let inaccuracyW = document.getElementById('inaccuracyW').value
        let mistakeW = document.getElementById('mistakeW').value
        let blunderW = document.getElementById('blunderW').value
        let missedW = document.getElementById('missedW').value

        let brilliantB = document.getElementById('brilliantB').value
        let greatB = document.getElementById('greatB').value
        let bestB = document.getElementById('bestB').value
        let excellentB = document.getElementById('excellentB').value
        let goodB = document.getElementById('goodB').value
        let bookB = document.getElementById('bookB').value
        let inaccuracyB = document.getElementById('inaccuracyB').value
        let mistakeB = document.getElementById('mistakeB').value
        let blunderB = document.getElementById('blunderB').value
        let missedB = document.getElementById('missedB').value

        let additive = parseInt(tempSeen[0])
        let numID = additive+1
        let gameID = numID.toString()
        tempSeen.unshift(gameID);

        tempData.forEach(element => {
            if(whitePlayer === element.name){
                element.games.push({
                    date: dateValue,
                    white: whitePlayer,
                    black: blackPlayer,
                    winner: winner,
                    brilliantW: brilliantW,
                    greatW: greatW,
                    bestW: bestW,
                    excellentW: excellentW,
                    goodW: goodW,
                    bookW: bookW,
                    inaccuracyW: inaccuracyW,
                    mistakeW: mistakeW,
                    blunderW: blunderW,
                    missedW: missedW,
                    brilliantB: brilliantB,
                    greatB: greatB,
                    bestB: bestB,
                    excellentB: excellentB,
                    goodB: goodB,
                    bookB: bookB,
                    inaccuracyB: inaccuracyB,
                    mistakeB: mistakeB,
                    blunderB: blunderB,
                    missedB: missedB,
                    type: gameType,
                    id: gameID
                })
            }else if(blackPlayer === element.name){
                element.games.push({
                    date: dateValue,
                    white: whitePlayer,
                    black: blackPlayer,
                    winner: winner,
                    brilliantW: brilliantW,
                    greatW: greatW,
                    bestW: bestW,
                    excellentW: excellentW,
                    goodW: goodW,
                    bookW: bookW,
                    inaccuracyW: inaccuracyW,
                    mistakeW: mistakeW,
                    blunderW: blunderW,
                    missedW: missedW,
                    brilliantB: brilliantB,
                    greatB: greatB,
                    bestB: bestB,
                    excellentB: excellentB,
                    goodB: goodB,
                    bookB: bookB,
                    inaccuracyB: inaccuracyB,
                    mistakeB: mistakeB,
                    blunderB: blunderB,
                    missedB: missedB,
                    type: gameType,
                    id: gameID
                })
            }
        });
        let playersString = JSON.stringify(tempData);
        localStorage.setItem("data", playersString);

        let seenString = JSON.stringify(tempSeen)
        localStorage.setItem("seen", seenString)
    }
</script>

</html>